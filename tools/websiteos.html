<div class="tool-container">
    <div class="input-group">
        <label>Enter Domain or IP Address</label>
        <input type="text" id="osHost" placeholder="e.g., example.com" />
    </div>
    <button class="primary-btn" onclick="checkOS()"><i data-lucide="search"></i> Check Website OS</button>

    <div class="results hidden" id="osResults">
        <div class="hash-row" style="margin-top:0">
            <label>Server Software / OS</label>
            <div class="hash-value-box">
                <code id="outOS">Analyzing...</code>
            </div>
        </div>
    </div>
</div>

<style>
    /* Se aplică aceleași stiluri comune ca mai sus */
    .tool-container { background: var(--color-bg-1); padding: 20px; border-radius: var(--radius-lg); border: 1px solid var(--color-border); }
    .input-group { margin-bottom: 15px; }
    .input-group label { display: block; font-weight: bold; margin-bottom: 5px; color: var(--color-primary); font-size: 0.9rem; }
    .input-group input { width: 100%; padding: 10px; border: 1px solid var(--color-border); background: var(--color-bg-2); color: var(--color-text); border-radius: 4px; }
    .primary-btn { display: flex; align-items: center; gap: 8px; background: var(--color-primary); color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: bold; transition: 0.2s; width: 100%; justify-content: center; }
    .primary-btn:hover { opacity: 0.9; }
    .results.hidden { display: none; }
    .results { margin-top: 20px; animation: fadeIn 0.3s ease; }
    .hash-row label { display: block; font-weight: bold; margin-bottom: 5px; color: var(--color-primary); font-size: 0.9rem; }
    .hash-value-box { display: flex; align-items: center; background: var(--color-bg-2); border: 1px solid var(--color-border); border-radius: 4px; }
    .hash-value-box code { flex: 1; padding: 12px; font-family: var(--font-family-mono); font-size: 0.9rem; }
</style>

<script>
    if(window.lucide) window.lucide.createIcons();

    window.checkOS = async function() {
        let host = document.getElementById('osHost').value.trim();
        if(!host) return;
        if(!host.startsWith('http')) host = 'http://' + host;

        document.getElementById('osResults').classList.remove('hidden');
        document.getElementById('outOS').textContent = "Fetching headers...";

        try {
            const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(host)}`);
            const data = await response.json();
            
            let serverStr = "Hidden / Unknown OS";
            const match = data.contents.match(/server:\s*(.*)/i) || (data.status.headers && typeof data.status.headers === 'object' && data.status.headers.server);
            
            if(match) {
                serverStr = Array.isArray(match) ? match[1] : match;
            } else if (data.status && data.status.url) {
                 serverStr = "Cannot determine (Hidden behind CDN / Firewall)";
            }

            document.getElementById('outOS').textContent = serverStr.trim();
        } catch (err) {
            document.getElementById('outOS').textContent = "Error resolving host. Ensure it is reachable.";
        }
    };
</script>